apiVersion: 1
# ğŸ“Œ Version du format de provisioning Grafana
# apiVersion: 1 = format actuel (stable depuis Grafana 8+)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“ CONFIGURATION MINIMALE
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Ce fichier est quasi-vide car en V3 :
# 1. Unified Alerting activÃ© via docker-compose.yml (GF_UNIFIED_ALERTING_ENABLED: "true")
# 2. Contact points (Discord webhook) configurÃ©s manuellement dans UI Grafana
# 3. Notification policies dÃ©finies via UI (flexibilitÃ© pour itÃ©rer)
#
# ğŸ’¡ POURQUOI PAS DE CONFIG ICI ?
# Grafana Unified Alerting = systÃ¨me complexe, provisioning YAML verbeux.
# Pour apprentissage : UI plus intuitive (visual editor).
# En production mature : migrer vers provisioning complet (gitops).

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“ PROVISIONING COMPLET (exemple pour aller plus loin)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Pour automatiser complÃ¨tement, ajouter :
#
# contactPoints:
#   - orgId: 1
#     name: discord-alerts
#     receivers:
#       - uid: discord-webhook
#         type: discord
#         settings:
#           url: ${DISCORD_WEBHOOK_URL}  # Variable depuis docker-compose
#           message: |
#             {{ template "default.title" . }}
#             {{ template "default.message" . }}
#
# policies:
#   - orgId: 1
#     receiver: discord-alerts
#     group_by: ['alertname', 'severity']
#     group_wait: 30s
#     group_interval: 5m
#     repeat_interval: 4h
#     routes:
#       - receiver: discord-alerts
#         matchers:
#           - severity = critical
#         continue: false
#
# ğŸ“š DOCUMENTATION
# https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ› ï¸ SETUP MANUEL ACTUEL (via UI Grafana)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# 1. AccÃ©der Ã  Grafana : http://localhost:3000
# 2. Alerting â†’ Contact points â†’ Add contact point
# 3. Type : Discord
# 4. Webhook URL : coller depuis .env
# 5. Test : Send test notification
# 6. Save contact point
#
# 7. Alerting â†’ Notification policies â†’ Edit default policy
# 8. Default contact point : sÃ©lectionner Discord
# 9. Save policy
#
# 10. Dashboards â†’ CrÃ©er alertes depuis panels
#     (Edit panel â†’ Alert tab â†’ Create alert rule)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”„ MIGRATION VERS PROVISIONING (recommandÃ© en prod)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# AVANTAGES
# âœ… VersionnÃ© dans Git (audit trail, rollback)
# âœ… Reproductible (staging = prod)
# âœ… Ã‰vite clics manuels (erreurs humaines)
#
# PROCESSUS
# 1. Configurer alertes manuellement (prototypage)
# 2. Exporter config via API Grafana
# 3. Convertir JSON â†’ YAML provisioning
# 4. Tester sur environnement staging
# 5. Commit dans Git + dÃ©ploiement automatisÃ©
#
# COMMANDES EXPORT
#   curl -u admin:admin http://localhost:3000/api/v1/provisioning/contact-points
#   curl -u admin:admin http://localhost:3000/api/v1/provisioning/policies
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•